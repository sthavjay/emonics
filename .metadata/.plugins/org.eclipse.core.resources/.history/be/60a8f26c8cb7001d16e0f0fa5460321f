package emonics.hrapp.service;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.List;

import emonics.hrapp.models.beans.Department;
import emonics.hrapp.models.beans.Employee;

public class EmployeeDaoImplV1 implements EmployeeDao{
	
	
	
	public Connection getConnection() throws SQLException {
		Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/employee","root","Trishna@123");
		return con;
	}

	@Override
	public Employee findById(int id) throws HrException{
		Employee e=new Employee();
		try(Connection con=getConnection();
		Statement st=con.createStatement();
		ResultSet rs=st.executeQuery("SELECT * FROM employee where EMP_ID="+id))
		{
			if(rs.next()) {
				
				e.setId(rs.getInt("EMP_ID"));
				e.setName(rs.getString("EMP_NAME"));
				e.setSalary(rs.getDouble("SALARY"));
				//e.setDeptId(rs.getInt("DEPT_ID"));
			}
			
			
		}catch(SQLException s) {
			String message=s.getMessage();
			throw new HrException("Error from finding records by id ["+s+"]");
		}
		
		return e;
	}

	@Override
	public boolean insert(Employee e) throws HrException {
		boolean success=false;
		try(Connection con=getConnection();
			PreparedStatement st=con.prepareStatement("INSERT INTO employee VALUES (?, ?, ?, ?)"))
		{
			st.setInt(1, e.getId());
			st.setString(2, e.getName());
			st.setDouble(3, e.getSalary());
			//st.setInt(4, e.getDeptId());
			if(st.executeUpdate()>0) {
				success=true;
			}
		
		}catch(SQLException s) {
			String message=s.getMessage();
			throw new HrException("Error from finding records by id ["+s+"]");
		}
		return success;
	}

	@Override
	public boolean update(Employee e) throws HrException {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean delete(Employee e) throws HrException {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public Department findDeptById(int id) throws HrException {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<Employee> findAll() throws HrException {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<Employee> findEmployeeByDept(int did) throws HrException {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<Employee> findAllUsinCQ() throws HrException {
		// TODO Auto-generated method stub
		return null;
	}

}
